# TruSight Cancer File Copy
***
## Introduction
Tool to copy files required for coverage assessment for the TruSight Cancer analysis. Renames the directories created with numbers in front in the order of the samples on the worksheet created in Shire (e.g. 01 20M01234)  

***
## Installation
This software uses Python 3.7.

It has dependencies which are recommended to be installed using a Conda environment. 
Install Conda:

```
https://docs.conda.io/projects/conda/en/latest/user-guide/install/download.html
```

Clone the repository:

```
git clone https://github.com/AWGL/copy_tsca
```

Create Conda environment:

```
conda env create -f tsca_copy.yml
```

Set up the config file to point to the correct locations on the local computer:


Edit ```config.py``` and save as ```config.py```


The code can then be run after the Conda environment is activated:

```
python copy_tsca.py
```
***
## Packaging for deployment
The software needs to be packaged to run on imaged PCs without Python installed. The package needs to be built on a Windows 7 PC with Python 3.7 installed.

Install pyinstaller if it is not already installed:

```
conda install pyinstaller
```

Package the software:

```
pyinstaller copy_tsca.py
```
***
## Deployment
Copy the dist directory generated by pyinstaller to the PC or shared drive from which the sofware is to be run. 

It may be useful to create a shortcut to the executable file ```copy_tsca.exe``` for the user.
***
## Instructions for usage
### Running the software
Double click on the ```copy_tsca.exe``` file.
### Using the software
1. Wait for a pop-up box called "TSCa File Copy Data Entry" to appear, enter the run identifier in the pop-up box and click OK

2. Wait for a second pop-up box with logging information to appear. This box is called "TSCa File Copy Information" and read the message.
	* If the message indicates that the software has finished correctly, the files and directories have been created.
	* If there is an error message displayed, **the software has not executed correctly**, click OK **and perform troubleshooting.**
	
***

## Troubleshooting
A log file ```tsca_copy.log``` is generated at each execution of the software to aid troubleshooting

***
## Notes
### Current known issues
* The test suite is incomplete

### Dependency List
In case the Conda environment build fails.

* python 3.7
* tkinter
* xlrd
* openpyxl
* pandas
* reportlab
* lxml






